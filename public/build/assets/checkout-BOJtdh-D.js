import{c as E,r as n,j as e,F as A,a as M,u as L,b as O,d as T}from"./app-C45-UGz_.js";import{B as y,H as I,u as H,M as R,P as Z,T as B}from"./header-B6qYbPWe.js";import{F as D}from"./footer-DSE2QGqs.js";import{I as i}from"./input-RhVK11Hi.js";import{D as G,a as z,b as J,c as Y,d as $}from"./dialog-c1Mby4Dt.js";import{s as K,C as Q}from"./index-B4Oe-qRV.js";import{L as N}from"./label-CmuQqU3u.js";import{S as U}from"./spinner-Zdk9enuG.js";import{I as P}from"./input-error-CFZSIZI8.js";/* empty css            */import"./check-BiRIPfLj.js";import"./index-CMWG4mbA.js";import"./loader-circle-k1C5fWZb.js";function V(c){const a=E.c(7),{text:l}=c,[m,p]=n.useState(!1);let r;a[0]!==l?(r=e.jsx(z,{asChild:!0,children:e.jsx(y,{variant:"ghost",className:"text-primary hover:underline font-medium",children:l})}),a[0]=l,a[1]=r):r=a[1];let d;a[2]===Symbol.for("react.memo_cache_sentinel")?(d=e.jsx(J,{children:e.jsx(Y,{children:"Login"})}),a[2]=d):d=a[2];let x;a[3]===Symbol.for("react.memo_cache_sentinel")?(x=e.jsxs(G,{children:[d,e.jsx(A,{...K.form(),onSuccess:()=>{p(!1),M.visit("/checkout")},className:"flex flex-col gap-6",children:W})]}),a[3]=x):x=a[3];let t;return a[4]!==m||a[5]!==r?(t=e.jsxs($,{open:m,onOpenChange:p,children:[r,x]}),a[4]=m,a[5]=r,a[6]=t):t=a[6],t}function W(c){const{processing:a,errors:l}=c;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{htmlFor:"email",children:"Email address"}),e.jsx(i,{id:"email",type:"email",name:"email",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"email",placeholder:"email@example.com"}),e.jsx(P,{message:l.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(N,{htmlFor:"password",children:"Password"})}),e.jsx(i,{id:"password",type:"password",name:"password",required:!0,tabIndex:2,autoComplete:"current-password",placeholder:"Password"}),e.jsx(P,{message:l.password})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Q,{id:"remember",name:"remember",tabIndex:3}),e.jsx(N,{htmlFor:"remember",children:"Remember me"})]}),e.jsxs(y,{type:"submit",className:"mt-4 w-full",tabIndex:4,disabled:a,"data-test":"login-button",children:[a&&e.jsx(U,{}),"Log in"]})]})})}function xe(){const{updateAppearance:c}=L(),{auth:a,cart:l}=O().props,{update:m,remove:p}=H(),r=!a?.user,[d,x]=n.useState(!1),[t,h]=n.useState({name:"",email:"",password:"",delivery_address:""}),[u,w]=n.useState({email:"",password:""}),[j,S]=n.useState(""),[C,_]=n.useState("espees"),[k,g]=n.useState(!1),[F,f]=n.useState(null);n.useEffect(()=>{c("light")},[c]);const q=async s=>{s.preventDefault(),f(null),g(!0);try{const o=r?d?j:t.delivery_address:j;if(!o||o.trim()===""){f("Please provide a delivery address"),g(!1);return}const v={payment_method:C,delivery_address:o};r&&(d?v.email=u.email:v.email=t.email);const b=await T.post("/checkout/create-order",v);b.data.success&&b.data.payment_url?window.location.href=b.data.payment_url:(f(b.data.error||"Failed to initialize payment"),g(!1))}catch(o){console.log({err:o}),f(o.response?.data?.message||o.response?.data?.error||"An error occurred during checkout. Please try again."),g(!1)}};return!l?.items||l.items.length===0?e.jsxs("main",{className:"w-full",children:[e.jsx(I,{}),e.jsx("div",{className:"py-12"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-24 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Your cart is empty"}),e.jsx("a",{href:"/product",className:"text-primary hover:underline",children:"Continue shopping"})]}),e.jsx(D,{})]}):e.jsxs("main",{className:"w-full",children:[e.jsx(I,{}),e.jsx("div",{className:"py-12"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 md:py-12 border-b",children:[e.jsx("p",{className:"text-2xl font-bold",children:"Checkout"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Home / Checkout"})]}),e.jsx("section",{className:"bg-white",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-12 md:py-16",children:e.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r&&e.jsxs("div",{className:"rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Checkout Information"}),d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Email"}),e.jsx(i,{type:"email",required:!0,value:u.email,onChange:s=>w({...u,email:s.target.value}),placeholder:"your@email.com"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Password"}),e.jsx(i,{type:"password",required:!0,value:u.password,onChange:s=>w({...u,password:s.target.value}),placeholder:"Enter your password"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Delivery Address"}),e.jsx(i,{required:!0,value:j,onChange:s=>S(s.target.value),placeholder:"123 Main St, City, State ZIP"})]}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Don't have an account?"," ",e.jsx("button",{type:"button",onClick:()=>x(!1),className:"text-primary hover:underline font-medium",children:"Continue as guest"})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-4 text-sm text-slate-600",children:["Do you have an account?"," ",e.jsx(V,{text:"Login here"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Full Name"}),e.jsx(i,{required:!0,value:t.name,onChange:s=>h({...t,name:s.target.value}),placeholder:"John Doe"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Email"}),e.jsx(i,{type:"email",required:!0,value:t.email,onChange:s=>h({...t,email:s.target.value}),placeholder:"john@example.com"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Password (Optional)"}),e.jsx(i,{type:"password",value:t.password,onChange:s=>h({...t,password:s.target.value}),placeholder:"Create password to save account"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Leave blank to checkout without account"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Delivery Address"}),e.jsx(i,{required:!0,value:t.delivery_address,onChange:s=>h({...t,delivery_address:s.target.value}),placeholder:"123 Main St, City, State ZIP"})]})]})]})})]}),!r&&e.jsxs("div",{className:"rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Delivery Address"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Delivery Address"}),e.jsx(i,{required:!0,value:j,onChange:s=>S(s.target.value),placeholder:"123 Main St, City, State ZIP"})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Payment Method"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center gap-3 p-3 border rounded cursor-pointer hover:bg-slate-50",children:[e.jsx("input",{type:"radio",name:"payment",value:"espees",checked:C==="espees",onChange:s=>_(s.target.value),className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Esprees"})]})})]}),F&&e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-4",children:e.jsx("p",{className:"text-sm text-red-600",children:F})})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24 rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 mb-6",children:l.items.map(s=>e.jsxs("div",{className:"flex gap-3 border-b pb-4",children:[e.jsx("img",{src:s.product.image,alt:s.product.name,className:"w-16 h-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:s.product.name}),e.jsx("div",{className:"text-slate-600 text-sm",children:s.product.price}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"p-1 rounded border hover:bg-slate-50",onClick:()=>m(String(s.id),Math.max(1,s.quantity-1)),children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-8 text-center text-slate-900",children:s.quantity}),e.jsx("button",{type:"button",className:"p-1 rounded border hover:bg-slate-50",onClick:()=>m(String(s.id),s.quantity+1),children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",className:"ml-auto p-1 text-red-500 hover:text-red-700",onClick:()=>p(String(s.id)),children:e.jsx(B,{className:"w-4 h-4"})})]})]})]},s.id))}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-slate-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:l.total})]}),e.jsxs("div",{className:"flex justify-between text-slate-600",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{children:"0.00"})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg pt-2 border-t",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:l.total})]})]}),e.jsx(y,{type:"submit",className:"w-full",disabled:k,style:{backgroundColor:"#FFA500",color:"black"},children:k?"Processing...":"Complete Order"})]})})]})})}),e.jsx(D,{})]})}export{xe as default};
