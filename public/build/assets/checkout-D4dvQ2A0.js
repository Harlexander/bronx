import{c as L,r as n,j as e,F as O,a as T,u as H,b as R,d as P}from"./app-CoHm6sa1.js";import{B as w,H as _,C as v,u as Z,M as B,P as G,T as z}from"./header-DVIgFi64.js";import{F as q}from"./footer-_spNjJ8X.js";import{I as i}from"./input-BX4Tr1w2.js";import{D as J,a as U,b as Y,c as $,d as K}from"./dialog-C7eufZBC.js";import{s as Q,C as V}from"./index-DnjFuiZ0.js";import{L as y}from"./label-D9zUJNb3.js";import{S as W}from"./spinner-B-4tFqKO.js";import{I as E}from"./input-error-DqRHBQTy.js";/* empty css            */import"./check-BXv0lb21.js";import"./index-CMWG4mbA.js";import"./loader-circle-DT5XHfKR.js";function X(c){const a=L.c(7),{text:l}=c,[m,j]=n.useState(!1);let r;a[0]!==l?(r=e.jsx(U,{asChild:!0,children:e.jsx(w,{variant:"ghost",className:"text-primary hover:underline font-medium",children:l})}),a[0]=l,a[1]=r):r=a[1];let d;a[2]===Symbol.for("react.memo_cache_sentinel")?(d=e.jsx(Y,{children:e.jsx($,{children:"Login"})}),a[2]=d):d=a[2];let x;a[3]===Symbol.for("react.memo_cache_sentinel")?(x=e.jsxs(J,{children:[d,e.jsx(O,{...Q.form(),onSuccess:()=>{j(!1),T.visit("/checkout")},className:"flex flex-col gap-6",children:ee})]}),a[3]=x):x=a[3];let t;return a[4]!==m||a[5]!==r?(t=e.jsxs(K,{open:m,onOpenChange:j,children:[r,x]}),a[4]=m,a[5]=r,a[6]=t):t=a[6],t}function ee(c){const{processing:a,errors:l}=c;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"email",children:"Email address"}),e.jsx(i,{id:"email",type:"email",name:"email",required:!0,autoFocus:!0,tabIndex:1,autoComplete:"email",placeholder:"email@example.com"}),e.jsx(E,{message:l.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(y,{htmlFor:"password",children:"Password"})}),e.jsx(i,{id:"password",type:"password",name:"password",required:!0,tabIndex:2,autoComplete:"current-password",placeholder:"Password"}),e.jsx(E,{message:l.password})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(V,{id:"remember",name:"remember",tabIndex:3}),e.jsx(y,{htmlFor:"remember",children:"Remember me"})]}),e.jsxs(w,{type:"submit",className:"mt-4 w-full",tabIndex:4,disabled:a,"data-test":"login-button",children:[a&&e.jsx(W,{}),"Log in"]})]})})}function ue(){const{updateAppearance:c}=H(),{auth:a,cart:l}=R().props,{update:m,remove:j}=Z(),r=!a?.user,[d,x]=n.useState(!1),[t,g]=n.useState({name:"",email:"",password:"",delivery_address:""}),[p,C]=n.useState({email:"",password:""}),[f,S]=n.useState(""),[k,A]=n.useState("espees"),[F,u]=n.useState(!1),[I,h]=n.useState(null);n.useEffect(()=>{c("light")},[c]);const M=async s=>{s.preventDefault(),h(null),u(!0);try{if(r&&!d&&t.password&&t.password.trim().length>=6)try{await P.post("/register",{name:t.name,email:t.email,password:t.password,password_confirmation:t.password})}catch(D){h(D.response?.data?.message||D.response?.data?.error||"Unable to register. Please check your details and try again."),u(!1);return}const o=r?d?f:t.delivery_address:f;if(!o||o.trim()===""){h("Please provide a delivery address"),u(!1);return}const N={payment_method:k,delivery_address:o};r&&(d?N.email=p.email:N.email=t.email);const b=await P.post("/checkout/create-order",N);b.data.success&&b.data.payment_url?window.location.href=b.data.payment_url:(h(b.data.error||"Failed to initialize payment"),u(!1))}catch(o){console.log({err:o}),h(o.response?.data?.message||o.response?.data?.error||"An error occurred during checkout. Please try again."),u(!1)}};return!l?.items||l.items.length===0?e.jsxs("main",{className:"w-full",children:[e.jsx(_,{}),e.jsx("div",{className:"py-12"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-24 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Your cart is empty"}),e.jsx("a",{href:"/product",className:"text-primary hover:underline",children:"Continue shopping"})]}),e.jsx(q,{})]}):e.jsxs("main",{className:"w-full",children:[e.jsx(_,{}),e.jsx("div",{className:"py-12"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 md:py-12 border-b",children:[e.jsx("p",{className:"text-2xl font-bold",children:"Checkout"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Home / Checkout"})]}),e.jsx("section",{className:"bg-white",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-12 md:py-16",children:e.jsxs("form",{onSubmit:M,className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r&&e.jsxs("div",{className:"rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Checkout Information"}),d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Email"}),e.jsx(i,{type:"email",required:!0,value:p.email,onChange:s=>C({...p,email:s.target.value}),placeholder:"your@email.com"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Password"}),e.jsx(i,{type:"password",required:!0,value:p.password,onChange:s=>C({...p,password:s.target.value}),placeholder:"Enter your password"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Delivery Address"}),e.jsx(i,{required:!0,value:f,onChange:s=>S(s.target.value),placeholder:"123 Main St, City, State ZIP"})]}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Don't have an account?"," ",e.jsx("button",{type:"button",onClick:()=>x(!1),className:"text-primary hover:underline font-medium",children:"Continue as guest"})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-4 text-sm text-slate-600",children:["Do you have an account?"," ",e.jsx(X,{text:"Login here"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Full Name"}),e.jsx(i,{required:!0,value:t.name,onChange:s=>g({...t,name:s.target.value}),placeholder:"John Doe"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Email"}),e.jsx(i,{type:"email",required:!0,value:t.email,onChange:s=>g({...t,email:s.target.value}),placeholder:"john@example.com"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Password (Optional)"}),e.jsx(i,{type:"password",value:t.password,onChange:s=>g({...t,password:s.target.value}),placeholder:"Create password to save account"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Leave blank to checkout without account"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Delivery Address"}),e.jsx(i,{required:!0,value:t.delivery_address,onChange:s=>g({...t,delivery_address:s.target.value}),placeholder:"123 Main St, City, State ZIP"})]})]})]})})]}),!r&&e.jsxs("div",{className:"rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Delivery Address"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Delivery Address"}),e.jsx(i,{required:!0,value:f,onChange:s=>S(s.target.value),placeholder:"123 Main St, City, State ZIP"})]})]}),e.jsxs("div",{className:"rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Payment Method"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center gap-3 p-3 border rounded cursor-pointer hover:bg-slate-50",children:[e.jsx("input",{type:"radio",name:"payment",value:"espees",checked:k==="espees",onChange:s=>A(s.target.value),className:"w-4 h-4"}),e.jsx(v,{children:e.jsx("span",{className:"font-medium",children:"Espees"})})]})})]}),I&&e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-4",children:e.jsx("p",{className:"text-sm text-red-600",children:I})})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"sticky top-24 rounded-xl border border-slate-200 p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 mb-6",children:l.items.map(s=>e.jsxs("div",{className:"flex gap-3 border-b pb-4",children:[e.jsx("img",{src:s.product.image,alt:s.product.name,className:"w-16 h-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-900",children:s.product.name}),e.jsx("div",{className:"text-slate-600 text-sm",children:s.product.price}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"p-1 rounded border hover:bg-slate-50",onClick:()=>m(String(s.id),Math.max(1,s.quantity-1)),children:e.jsx(B,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-8 text-center text-slate-900",children:s.quantity}),e.jsx("button",{type:"button",className:"p-1 rounded border hover:bg-slate-50",onClick:()=>m(String(s.id),s.quantity+1),children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",className:"ml-auto p-1 text-red-500 hover:text-red-700",onClick:()=>j(String(s.id)),children:e.jsx(z,{className:"w-4 h-4"})})]})]})]},s.id))}),e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-slate-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsx(v,{children:e.jsx("span",{children:l.total})})]}),e.jsxs("div",{className:"flex justify-between text-slate-600",children:[e.jsx("span",{children:"Shipping"}),e.jsx(v,{children:e.jsx("span",{children:"0.00"})})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg pt-2 border-t",children:[e.jsx("span",{children:"Total"}),e.jsx(v,{children:e.jsx("span",{children:l.total})})]})]}),e.jsx(w,{type:"submit",className:"w-full",disabled:F,style:{backgroundColor:"#FFA500",color:"black"},children:F?"Processing...":"Complete Order"})]})})]})})}),e.jsx(q,{})]})}export{ue as default};
